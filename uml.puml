@startuml
class notification.EmailNotifier {
- String senderEmail
- String appPassword
+ void notify(User,String)
}


interface domain.fine.FineStrategy {
~ int calculateFine(int)
}

class service.ReminderService {
- List<Observer> observers
+ boolean addObserver(Observer)
- void notifyObservers(User,String)
+ void sendReminders(List<Loan>,List<CDLoan>)
}


class domain.fine.CDFineStrategy {
+ int calculateFine(int)
}

class service.AdminService {
- List<Admin> admins
- Admin loggedInAdmin
+ boolean addAdmin(String,int,String)
+ boolean login(String,String)
+ void logout()
+ boolean isAdminLoggedIn()
+ Admin getLoggedInAdmin()
+ List<Admin> getAllAdmins()
}


class service.LibraryService {
- UserService userService
- BookService bookService
- LoanService loanService
- CDLoanService cdLoanService
- ReminderService reminderService
+ User findUserByName(String)
+ Book findBookByISBN(String)
+ CD findCDById(List<CD>,String)
+ User findLoanUser(Book)
+ boolean borrowBook(User,Book)
+ boolean returnBook(User,Book)
+ boolean borrowCD(User,CD)
+ boolean returnCD(User,CD)
+ List<Loan> getOverdueLoans()
+ List<CDLoan> getOverdueCDLoans()
+ List<Loan> getAllLoans()
+ List<CDLoan> getAllCDLoans()
+ void sendOverdueReminders()
+ List<User> getAllUsers()
+ List<Book> getAllBooks()
}


class domain.Loan {
- User user
- Book book
- LocalDate borrowDate
- LocalDate dueDate
- FineStrategy fineStrategy
- boolean active
+ void returnBook()
+ boolean isActive()
+ boolean isOverdue(LocalDate)
+ boolean isOverdue()
+ int getOverdueDays()
+ int calculateFine()
+ void setBorrowDate(LocalDate)
+ void setDueDate(LocalDate)
+ void setFineStrategy(FineStrategy)
+ User getUser()
+ Book getBook()
+ LocalDate getBorrowDate()
+ LocalDate getDueDate()
+ FineStrategy getFineStrategy()
+ String toString()
}


class domain.fine.BookFineStrategy {
+ int calculateFine(int)
}

class domain.Admin {
- String userName
- int adminId
- String password
- boolean loggedIn
+ boolean login(String,String)
+ void logout()
+ boolean isLoggedIn()
+ String getUserName()
+ int getAdminId()
+ String getPassword()
+ void setUserName(String)
+ void setPassword(String)
+ String toString()
}


class domain.CDLoan {
- User user
- CD cd
- LocalDate borrowDate
- LocalDate dueDate
- FineStrategy fineStrategy
- boolean active
+ void returnCD()
+ boolean isActive()
+ boolean isOverdue(LocalDate)
+ boolean isOverdue()
+ int getOverdueDays()
+ int calculateFine()
+ void setBorrowDate(LocalDate)
+ void setDueDate(LocalDate)
+ User getUser()
+ CD getCD()
+ LocalDate getBorrowDate()
+ LocalDate getDueDate()
+ String toString()
}


class domain.User {
- String name
- String email
- double fineBalance
- List<Loan> activeBookLoans
- List<CDLoan> activeCDLoans
+ String getUserName()
+ String getEmail()
+ double getFineBalance()
+ List<Loan> getActiveBookLoans()
+ List<CDLoan> getActiveCDLoans()
+ void setEmail(String)
+ void setFineBalance(double)
+ void addLoan(Loan)
+ void addCDLoan(CDLoan)
+ void returnLoan(Loan)
+ void returnCDLoan(CDLoan)
+ boolean hasOverdueLoans()
+ int getOverdueCount()
+ void payFine(double)
+ boolean canBeUnregistered()
+ String toString()
}


class service.UserService {
- List<User> users
- {static} String USERS_FILE
+ boolean addUser(String,String)
+ boolean addUser(String)
- void saveUsers()
+ void loadUsersFromFile()
+ User findUserByName(String)
+ List<User> getAllUsers()
+ boolean canBorrow(User)
+ boolean unregisterUser(User)
}


class service.BookService {
- List<Book> books
- {static} String BOOKS_FILE
+ boolean addBook(String,String,String)
- void saveBooksToFile()
+ void loadBooksFromFile()
+ List<Book> search(String)
+ Book findBookByISBN(String)
+ List<Book> getAllBooks()
}


class domain.CD {
- String title
- String artist
- String id
- boolean available
- LocalDate borrowDate
- LocalDate dueDate
+ void borrowCD(LocalDate)
+ void borrowCD()
+ void returnCD()
+ boolean isOverdue(LocalDate)
+ boolean isOverdue()
+ int getRemainingDays(LocalDate)
+ boolean isAvailable()
+ LocalDate getBorrowDate()
+ LocalDate getDueDate()
+ String getTitle()
+ String getArtist()
+ String getId()
+ String toString()
}


class domain.Book {
- String title
- String author
- String isbn
- boolean available
- LocalDate borrowDate
- LocalDate dueDate
+ boolean isAvailable()
+ void borrowBook(LocalDate)
+ void borrowBook()
+ void returnBook()
+ boolean isOverdue(LocalDate)
+ boolean isOverdue()
+ int getRemainingDays(LocalDate)
+ LocalDate getDueDate()
+ LocalDate getBorrowDate()
+ String getTitle()
+ String getAuthor()
+ String getIsbn()
+ boolean isBorrowed()
+ void setAvailable(boolean)
+ void setBorrowDate(LocalDate)
+ void setDueDate(LocalDate)
+ String toString()
}


class service.CDLoanService {
- List<CDLoan> cdLoans
- BookService bookService
- UserService userService
- {static} String LOANS_FILE
+ boolean createCDLoan(User,CD)
+ boolean returnCDLoan(User,CD)
~ void saveLoanToFile(CDLoan)
+ void loadCDLoansFromFile(List<CD>)
+ List<CDLoan> getOverdueCDLoans()
+ List<CDLoan> getAllCDLoans()
}


class presentation.Main {
- {static} String ENTER_CHOICE
- {static} Scanner input
- {static} String RED
- {static} String GREEN
- {static} String CYAN
- {static} String YELLOW
- {static} String RESET
- {static} String INVALID
- {static} String INVALID_MSG
- {static} Logger LOGGER
+ {static} void main(String[])
- {static} void usersMenu(UserService)
- {static} void booksMenu(BookService)
- {static} void cdsMenu()
- {static} void loansMenu(LibraryService)
- {static} void borrowBook(LibraryService)
- {static} void returnBook(LibraryService)
- {static} void borrowCD(LibraryService)
- {static} void returnCD(LibraryService)
- {static} void listLoans(LibraryService)
- {static} void showOverdue(LibraryService)
- {static} void sendReminders(LibraryService)
- {static} int getInt()
}


class file.FileManager {
+ {static} List<String> readLines(String)
+ {static} void writeLines(String,List<String>)
+ {static} void appendLine(String,String)
}

class service.LoanService {
- List<Loan> loans
- BookService bookService
- UserService userService
- {static} String LOANS_FILE
+ boolean createLoan(User,Book)
- void saveLoanToFile(Loan)
+ void loadLoansFromFile()
+ boolean returnLoan(User,Book)
+ List<Loan> getOverdueLoans()
+ List<Loan> getAllLoans()
}


class notification.MockNotifier {
- List<String> messages
+ void notify(User,String)
+ List<String> getMessages()
}


interface notification.Observer {
~ void notify(User,String)
}



notification.Observer <|.. notification.EmailNotifier
domain.fine.FineStrategy <|.. domain.fine.CDFineStrategy
domain.fine.FineStrategy <|.. domain.fine.BookFineStrategy
notification.Observer <|.. notification.MockNotifier
@enduml